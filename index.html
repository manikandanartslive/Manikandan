<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>MANIKANDAN — AI Image Editor & Upscaler</title>
<style>
:root{
  --sky:#00bfff;
  --black:#000;
  --btn-bg:var(--sky);
  --btn-ink:#fff;
}
body{
  margin:0;padding:20px;font-family:'Segoe UI',sans-serif;background:#e6f7ff;
  display:flex;justify-content:center;align-items:center;min-height:100vh;
}
.container{
  background:#000;color:#fff;border-radius:16px;box-shadow:0 0 20px rgba(0,0,0,0.4);
  padding:20px;width:100%;max-width:900px;box-sizing:border-box;text-align:center;position:relative;
}
.logo{position:absolute;top:10px;left:10px;width:60px;border-radius:50%;}
h1{color:var(--sky);margin-top:60px;font-size:1.6rem;}
.preview{
  margin:20px auto;position:relative;width:100%;max-width:700px;border-radius:10px;overflow:hidden;
  background: repeating-conic-gradient(#ccc 0% 25%, transparent 0% 50%) 50% / 20px 20px;
  min-height:300px;display:flex;align-items:center;justify-content:center;
}
.preview img,.preview canvas{max-width:100%;display:block;}
button{
  padding:12px 16px;border:none;border-radius:10px;margin:5px;cursor:pointer;font-weight:bold;
  background:var(--btn-bg);color:var(--btn-ink);transition:all 0.3s ease;width:100%;max-width:200px;
}
button:hover{opacity:0.9;transform:scale(1.05);}
@keyframes glowRed{0%{box-shadow:0 0 5px red,0 0 10px red;}50%{box-shadow:0 0 20px red,0 0 40px red;}100%{box-shadow:0 0 5px red,0 0 10px red;}}
@keyframes glowGreen{0%{box-shadow:0 0 5px lime,0 0 10px lime;}50%{box-shadow:0 0 20px lime,0 0 40px lime;}100%{box-shadow:0 0 5px lime,0 0 10px lime;}}
#resetBtn{background:red;animation:glowRed 2s infinite alternate;}
#downloadBtn{background:green;animation:glowGreen 2s infinite alternate;}
select,input[type="file"]{background:#111;color:#fff;border:1px solid var(--sky);border-radius:8px;padding:8px;margin-top:10px;width:100%;max-width:300px;}
.progress-bar{width:100%;background:#222;border-radius:10px;overflow:hidden;height:15px;margin-top:10px;display:none;}
.progress-bar-fill{height:100%;width:0;background:var(--sky);transition:width 0.3s ease;}
.btn-group{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;margin-top:15px;}
@media(max-width:768px){
  .logo{width:50px;}
  h1{font-size:1.3rem;margin-top:70px;}
  button{max-width:150px;}
}
@media(max-width:480px){
  .logo{width:40px;}
  h1{font-size:1.1rem;margin-top:70px;}
  button{max-width:100%;}
}
</style>
</head>
<body>
<div class="container">
  <img src="IMG-20251028-WA0018(1).jpg" class="logo" alt="Logo">
  <h1>MANIKANDAN — AI Image Editor</h1>

  <input type="file" id="file" accept="image/*">
  <select id="preset">
    <option value="">Choose Preset</option>
    <option value="2k">2K</option><option value="4k">4K</option><option value="8k">8K</option>
    <option value="12k">12K</option><option value="16k">16K</option>
  </select>

  <div class="preview" id="previewWrap"><p id="noImageMsg" style="color:#fff;opacity:0.7">No image uploaded</p></div>

  <div class="progress-bar" id="progressBar"><div class="progress-bar-fill" id="progressFill"></div></div>

  <div class="btn-group">
    <button id="previewBtn">Preview Upscale</button>
    <button id="downloadBtn" disabled>Download Upscaled Image</button>
    <button id="resetBtn">Reset</button>
  </div>

  <div class="btn-group">
    <button id="enhanceBtn">AI Enhance</button>
    <button id="expandBtn">AI Expand</button>
    <button id="removeBgBtn">Remove Background</button>
  </div>

  <p id="status" style="color:var(--sky);">Waiting for image...</p>
</div>

<script>
const fileEl=document.getElementById('file');
const previewWrap=document.getElementById('previewWrap');
const preset=document.getElementById('preset');
const progressBar=document.getElementById('progressBar');
const progressFill=document.getElementById('progressFill');
const downloadBtn=document.getElementById('downloadBtn');
const enhanceBtn=document.getElementById('enhanceBtn');
const expandBtn=document.getElementById('expandBtn');
const removeBgBtn=document.getElementById('removeBgBtn');
const resetBtn=document.getElementById('resetBtn');
const status=document.getElementById('status');
let originalImage=null,lastCanvas=null;

function setStatus(msg){status.textContent=msg;}
function updateProgress(pct){progressBar.style.display='block';progressFill.style.width=pct+'%';}

fileEl.addEventListener('change',e=>{
  const file=e.target.files[0];
  if(!file)return;
  const reader=new FileReader();
  reader.onload=ev=>{
    const img=new Image();
    img.onload=()=>{
      originalImage=img;
      previewWrap.innerHTML='';
      previewWrap.appendChild(img);
      lastCanvas=imageToCanvas(img);
      setStatus('Image uploaded successfully.');
      downloadBtn.disabled=false;
    };
    img.src=ev.target.result;
  };
  reader.readAsDataURL(file);
});

function imageToCanvas(img){
  const canvas=document.createElement('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=img.width;
  canvas.height=img.height;
  ctx.drawImage(img,0,0);
  return canvas;
}

document.getElementById('previewBtn').addEventListener('click',()=>{
  if(!originalImage)return setStatus('Upload an image first.');
  const presetVal=preset.value;
  if(!presetVal)return setStatus('Select upscale preset (2K,4K...)');
  setStatus('Upscaling to '+presetVal.toUpperCase()+'...');
  updateProgress(10);
  const scaleMap={ '2k':2,'4k':4,'8k':8,'12k':12,'16k':16 };
  const scale=scaleMap[presetVal]||2;
  const canvas=document.createElement('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=originalImage.width*scale;
  canvas.height=originalImage.height*scale;
  ctx.drawImage(originalImage,0,0,canvas.width,canvas.height);
  lastCanvas=canvas;
  previewWrap.innerHTML='';
  previewWrap.appendChild(canvas);
  let pct=10;
  const interval=setInterval(()=>{
    pct+=10;updateProgress(pct);
    if(pct>=100){clearInterval(interval);progressBar.style.display='none';setStatus('Upscaling complete: '+presetVal.toUpperCase());}
  },100);
});

removeBgBtn.addEventListener('click',()=>{
  if(!lastCanvas)return setStatus('Please upload an image first.');
  setStatus('Removing background...');
  updateProgress(20);
  const canvas=document.createElement('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=lastCanvas.width;canvas.height=lastCanvas.height;
  ctx.drawImage(lastCanvas,0,0);
  const imgData=ctx.getImageData(0,0,canvas.width,canvas.height);
  const data=imgData.data;

  // Sample average edge color
  const edgeSamples=[];
  for(let y=0;y<canvas.height;y+=Math.max(1,Math.floor(canvas.height/50))){
    for(let x=0;x<canvas.width;x+=Math.max(1,Math.floor(canvas.width/50))){
      if(x<5||y<5||x>canvas.width-5||y>canvas.height-5){
        const i=(y*canvas.width+x)*4;
        edgeSamples.push([data[i],data[i+1],data[i+2]]);
      }
    }
  }
  const avg=[0,0,0];
  edgeSamples.forEach(c=>{avg[0]+=c[0];avg[1]+=c[1];avg[2]+=c[2];});
  avg[0]/=edgeSamples.length;avg[1]/=edgeSamples.length;avg[2]/=edgeSamples.length;

  const tol=90; // stronger tolerance
  for(let i=0;i<data.length;i+=4){
    const diff=Math.sqrt((data[i]-avg[0])**2+(data[i+1]-avg[1])**2+(data[i+2]-avg[2])**2);
    if(diff<tol)data[i+3]=0;
  }

  ctx.putImageData(imgData,0,0);
  lastCanvas=canvas;
  previewWrap.innerHTML='';
  previewWrap.appendChild(canvas);
  updateProgress(100);
  setTimeout(()=>progressBar.style.display='none',800);
  setStatus('Background removed successfully.');
});

enhanceBtn.addEventListener('click',()=>{
  if(!lastCanvas)return setStatus('Upload or process an image first.');
  setStatus('Enhancing colors...');
  updateProgress(30);
  const canvas=document.createElement('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=lastCanvas.width;
  canvas.height=lastCanvas.height;
  ctx.drawImage(lastCanvas,0,0);
  const imgData=ctx.getImageData(0,0,canvas.width,canvas.height);
  const data=imgData.data;
  for(let i=0;i<data.length;i+=4){
    data[i]=Math.min(255,data[i]*1.15);     // red
    data[i+1]=Math.min(255,data[i+1]*1.15); // green
    data[i+2]=Math.min(255,data[i+2]*1.15); // blue
  }
  ctx.putImageData(imgData,0,0);
  lastCanvas=canvas;
  previewWrap.innerHTML='';
  previewWrap.appendChild(canvas);
  updateProgress(100);
  setTimeout(()=>progressBar.style.display='none',800);
  setStatus('AI Enhance complete.');
});

resetBtn.addEventListener('click',()=>{
  fileEl.value='';
  previewWrap.innerHTML='<p style="color:#fff;opacity:0.7">No image uploaded</p>';
  originalImage=null;lastCanvas=null;
  downloadBtn.disabled=true;
  setStatus('Reset complete. Waiting for image.');
});

downloadBtn.addEventListener('click',()=>{
  if(!lastCanvas)return setStatus('Nothing to download.');
  const link=document.createElement('a');
  link.download='processed-image.png';
  link.href=lastCanvas.toDataURL('image/png');
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  setStatus('Image downloaded successfully.');
});
</script>
</body>
</html>
